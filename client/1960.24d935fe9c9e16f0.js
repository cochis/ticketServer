"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1960],{1960:(O,d,s)=>{s.r(d),s.d(d,{EditarUsuariosPageModule:()=>M});var g=s(6814),r=s(6223),u=s(9843),c=s(1896),m=s(5861),f=s(553),i=s(5879),p=s(7203),h=s(5612),_=s(8042),v=s(3429),x=s(4726),b=s(2363);function T(o,n){if(1&o&&(i.TgZ(0,"ion-col",5)(1,"ion-item",6),i._UZ(2,"ion-input",17),i.qZA()()),2&o){const e=i.oxw();i.xp6(2),i.Q6J("readonly","false"===e.edit)}}function U(o,n){if(1&o&&(i.TgZ(0,"ion-col",5)(1,"ion-item",6),i._UZ(2,"ion-input",18),i.qZA()()),2&o){const e=i.oxw();i.xp6(2),i.Q6J("readonly","false"===e.edit)}}function Z(o,n){if(1&o&&i._UZ(0,"img",26),2&o){const e=i.oxw(3);i.Q6J("src",e.url+"/upload/usuarios/default.jpg"+e.usuario.img,i.LSH)}}function I(o,n){if(1&o&&i._UZ(0,"img",26),2&o){const e=i.oxw(3);i.Q6J("src",e.url+"/upload/usuarios/"+e.usuario.img,i.LSH)}}function P(o,n){if(1&o&&i._UZ(0,"img",27),2&o){const e=i.oxw(3);i.Q6J("src",e.imgTemp,i.LSH)("alt",e.usuario.nombre)}}function E(o,n){if(1&o&&(i.ynx(0),i.YNc(1,Z,1,1,"img",24),i.YNc(2,I,1,1,"img",24),i.YNc(3,P,1,2,"img",25),i.BQk()),2&o){const e=i.oxw(2);i.xp6(1),i.Q6J("ngIf",""===e.usuario.img&&!e.imgTemp),i.xp6(1),i.Q6J("ngIf",""!==e.usuario.img&&!e.imgTemp),i.xp6(1),i.Q6J("ngIf",""!==e.usuario.img&&e.imgTemp)}}function J(o,n){if(1&o){const e=i.EpF();i.TgZ(0,"ion-col",5)(1,"ion-item",19)(2,"div",20)(3,"ion-label"),i._uU(4,"Imagen"),i.qZA(),i.TgZ(5,"label",21),i.YNc(6,E,4,3,"ng-container",22),i.qZA(),i.TgZ(7,"input",23),i.NdJ("change",function(a){i.CHM(e);const l=i.oxw();return i.KtG(l.cambiarImagen(a))}),i.qZA()()()()}if(2&o){const e=i.oxw();i.xp6(6),i.Q6J("ngIf",e.usuario)}}function S(o,n){if(1&o&&i._UZ(0,"img",29),2&o){const e=i.oxw(3);i.Q6J("src",e.url+"/upload/usuarios/"+e.usuario.img,i.LSH)("alt",e.usuario.email)("title",e.usuario.email)}}function y(o,n){if(1&o&&i._UZ(0,"img",29),2&o){const e=i.oxw(3);i.Q6J("src",e.url+"/upload/usuarios/default.jpg",i.LSH)("alt",e.usuario.email)("title",e.usuario.email)}}function Q(o,n){if(1&o&&(i.ynx(0),i.YNc(1,S,1,3,"img",28),i.YNc(2,y,1,3,"img",28),i.BQk()),2&o){const e=i.oxw(2);i.xp6(1),i.Q6J("ngIf",""!==e.usuario.img),i.xp6(1),i.Q6J("ngIf",""===e.usuario.img)}}function N(o,n){if(1&o){const e=i.EpF();i.TgZ(0,"ion-col",5)(1,"ion-item",19)(2,"div",20)(3,"ion-label"),i._uU(4,"Imagen"),i.qZA(),i.TgZ(5,"label",21),i.YNc(6,Q,3,2,"ng-container",22),i.qZA(),i.TgZ(7,"input",23),i.NdJ("change",function(a){i.CHM(e);const l=i.oxw();return i.KtG(l.cambiarImagen(a))}),i.qZA()()()()}if(2&o){const e=i.oxw();i.xp6(6),i.Q6J("ngIf",e.usuario)}}function q(o,n){if(1&o&&(i.ynx(0),i.TgZ(1,"ion-select-option",32),i._uU(2),i.qZA(),i.BQk()),2&o){const e=n.$implicit;i.xp6(1),i.Q6J("value",e.uid),i.xp6(1),i.Oqu(e.nombre)}}function A(o,n){if(1&o&&(i.TgZ(0,"ion-col",5)(1,"ion-item",6)(2,"ion-select",30),i.YNc(3,q,3,2,"ng-container",31),i.qZA()()()),2&o){const e=i.oxw();i.xp6(3),i.Q6J("ngForOf",e.roles)}}function Y(o,n){if(1&o&&(i.ynx(0),i.TgZ(1,"ion-select-option",32),i._uU(2),i.qZA(),i.BQk()),2&o){const e=n.$implicit;i.xp6(1),i.Q6J("value",e.uid),i.xp6(1),i.Oqu(e.nombre)}}function C(o,n){if(1&o&&(i.TgZ(0,"ion-col",5)(1,"ion-item",6)(2,"ion-select",33),i.YNc(3,Y,3,2,"ng-container",31),i.qZA()()()),2&o){const e=i.oxw();i.xp6(3),i.Q6J("ngForOf",e.salons)}}function F(o,n){if(1&o&&(i.TgZ(0,"ion-col",14)(1,"ion-button",34),i._uU(2," Editar "),i.qZA()()),2&o){const e=i.oxw();i.xp6(1),i.Q6J("disabled",e.usuarioForm.invalid)}}const L=[{path:"",component:(()=>{var o;class n{constructor(t,a,l,R,w,B,H,G){this.functionsService=t,this.route=a,this.usuariosService=l,this.fb=R,this.router=w,this.rolesService=B,this.salonsService=H,this.fileService=G,this.today=this.functionsService.getToday(),this.roles=[],this.salons=[],this.formSubmitted=!1,this.cargando=!1,this.url=f.N.base_url,this.imgTemp=void 0,this.onLoading(),this.getRoles(),this.getSalones(),this.createForm(),this.id=this.route.snapshot.params.id,this.edit=this.route.snapshot.params.edit,setTimeout(()=>{this.getId(this.id),this.offLoading()},500)}getRoles(){this.rolesService.cargarRolesAll().subscribe(t=>{this.roles=t.roles},t=>{console.log("error::: ",t)})}getSalones(){this.salonsService.cargarSalonsAll().subscribe(t=>{this.salons=t.salons,console.log("this.salons ::: ",this.salons)},t=>{console.log("error::: ",t)})}ngOnInit(){}getId(t){console.log("id::: ",t),this.usuariosService.cargarUsuarioById(t).subscribe(a=>{console.log("resp.usuario::: ",a.usuario),this.usuario=a.usuario,this.setForm(this.usuario),this.offLoading()},a=>{this.offLoading()})}get errorControl(){return this.usuarioForm.controls}createForm(){this.usuarioForm=this.fb.group({nombre:["",[r.kI.required,r.kI.minLength(3)]],apellidoPaterno:["",[r.kI.required,r.kI.minLength(3)]],apellidoMaterno:[""],email:["",[r.kI.required,r.kI.email]],salon:[""],role:["",[r.kI.required]],google:[!1],activated:[!1],dateCreated:[this.today],lastEdited:[this.today]})}onSubmit(){if(this.onLoading(),!this.usuarioForm.valid)return this.functionsService.presentToast("bottom","Por favor completa el formulario","danger"),void this.offLoading();this.usuario={...this.usuario,...this.usuarioForm.value},this.usuariosService.actualizarUsuario(this.usuario).subscribe(t=>{this.functionsService.presentToast("bottom","Usuario Creado","primary"),this.functionsService.navigateTo("core/usuarios/vista-usuarios"),this.offLoading()},t=>{this.functionsService.presentToast("bottom","Error","danger"),this.offLoading()})}setForm(t){console.log("usuario::: ",t);var a=this.functionsService.getValueCatalog(t.role,"nombre",this.roles);console.log("role::: ",a);var l="";console.log("usuario.salon::: ",t.salon),t.salon&&(l=this.functionsService.getValueCatalog(t.salon,"nombre",this.salons)),this.usuarioForm=this.fb.group({nombre:[t.nombre,[r.kI.required,r.kI.minLength(3)]],apellidoPaterno:[t.apellidoPaterno,[r.kI.required,r.kI.minLength(3)]],apellidoMaterno:[t.apellidoMaterno],email:[t.email,[r.kI.required,r.kI.email]],role:["false"===this.edit?a:t.role,[r.kI.required]],salon:["false"===this.edit?l:t.salon,[r.kI.required]],google:[t.google],activated:[t.activated],dateCreated:[t.dateCreated],lastEdited:[this.today]})}cambiarImagen(t){if(this.imagenSubir=t.target.files[0],t.target.files[0]){console.log("file::: ",t.target.files[0]);const a=new FileReader;a.readAsDataURL(t.target.files[0]),a.onloadend=()=>{this.imgTemp=a.result,console.log("this.imgTemp ::: ",this.imgTemp)},this.subirImagen()}else this.imgTemp=null,console.log("!file::: ",this.imgTemp)}subirImagen(){this.fileService.actualizarFoto(this.imagenSubir,"usuarios",this.usuario.uid).then(t=>{this.usuario.img=t,this.functionsService.presentToast("bottom","Imagen actualizada","success")},t=>{this.functionsService.presentToast("bottom","Error al actualizar la imagen","danger")})}back(){this.functionsService.navigateTo("core/usuarios/vista-usuarios")}onLoading(){var t=this;this.functionsService.showLoading().then(function(){var a=(0,m.Z)(function*(l){t.loading=l});return function(l){return a.apply(this,arguments)}}())}offLoading(){setTimeout(()=>{this.functionsService.closeLoading(this.loading)},500)}}return(o=n).\u0275fac=function(t){return new(t||o)(i.Y36(p.d),i.Y36(c.gz),i.Y36(h.J),i.Y36(r.qu),i.Y36(c.F0),i.Y36(_.f),i.Y36(v.S),i.Y36(x.I))},o.\u0275cmp=i.Xpm({type:o,selectors:[["app-editar-usuarios"]],decls:29,vars:14,consts:[[3,"titulo"],[3,"fullscreen"],["novalidate","",3,"formGroup","ngSubmit"],["fixed","",1,"minHeight"],[1,"ion-text-center"],["size","12","size-md","6"],["lines","none"],["type","string","placeholder","Nombre(s)","name","nombre","label","Nombre","labelPlacement","floating","formControlName","nombre","required","",3,"readonly"],["size","12","size-md","3"],["type","string","placeholder","Apellido paterno","name","apellidoPaterno","label","Apellido paterno","labelPlacement","floating","formControlName","apellidoPaterno","required","",3,"readonly"],["type","string","placeholder","Apellido materno","name","apellidoMaterno","label","Apellido materno","labelPlacement","floating","formControlName","apellidoMaterno","required","",3,"readonly"],["type","email","placeholder","Correo electr\xf3nico","name","email","label","Correo electr\xf3nico","labelPlacement","floating","formControlName","email","required","",3,"readonly"],["size","12","size-md","6",4,"ngIf"],["fixed","",1,"ion-text-center"],["size","6"],["color","secondary","expand","block",1,"ion-padding","ion-no-border",3,"click"],["size","6",4,"ngIf"],["type","role","placeholder","Rol","name","role","label","Rol","labelPlacement","floating","formControlName","role","required","",3,"readonly"],["type","salon","placeholder","Rol","name","salon","label","Salon","labelPlacement","floating","formControlName","salon","required","",3,"readonly"],["lines","none",1,"ion-text-center"],[1,"image-upload"],["for","file-input",2,"text-align","center"],[4,"ngIf"],["id","file-input","type","file",1,"ion-no-border",3,"change"],["alt","Click aqu\xed para subir tu foto","title","Click aqu\xed para subir tu foto","class","img-avatar",3,"src",4,"ngIf"],["class","img-avatar",3,"src","alt",4,"ngIf"],["alt","Click aqu\xed para subir tu foto","title","Click aqu\xed para subir tu foto",1,"img-avatar",3,"src"],[1,"img-avatar",3,"src","alt"],["class","img-avatar",3,"src","alt","title",4,"ngIf"],[1,"img-avatar",3,"src","alt","title"],["label","Rol","label-placement","floating","formControlName","role","required",""],[4,"ngFor","ngForOf"],[3,"value"],["label","Salon","label-placement","floating","formControlName","salon","required",""],["color","primary","type","submit","expand","block",1,"ion-padding","ion-no-border",3,"disabled"]],template:function(t,a){1&t&&(i._UZ(0,"app-header",0),i.TgZ(1,"ion-content",1)(2,"form",2),i.NdJ("ngSubmit",function(){return a.onSubmit()}),i.TgZ(3,"ion-grid",3)(4,"ion-row",4)(5,"ion-col",5)(6,"ion-item",6),i._UZ(7,"ion-input",7),i.qZA()(),i.TgZ(8,"ion-col",8)(9,"ion-item",6),i._UZ(10,"ion-input",9),i.qZA()(),i.TgZ(11,"ion-col",8)(12,"ion-item",6),i._UZ(13,"ion-input",10),i.qZA()(),i.TgZ(14,"ion-col",5)(15,"ion-item",6),i._UZ(16,"ion-input",11),i.qZA()(),i.YNc(17,T,3,1,"ion-col",12),i.YNc(18,U,3,1,"ion-col",12),i.YNc(19,J,8,1,"ion-col",12),i.YNc(20,N,8,1,"ion-col",12),i.YNc(21,A,4,1,"ion-col",12),i.YNc(22,C,4,1,"ion-col",12),i.qZA()(),i.TgZ(23,"ion-grid",13)(24,"ion-row",4)(25,"ion-col",14)(26,"ion-button",15),i.NdJ("click",function(){return a.back()}),i._uU(27," Regresar "),i.qZA()(),i.YNc(28,F,3,1,"ion-col",16),i.qZA()()()()),2&t&&(i.Q6J("titulo","true"===a.edit?"Editar usuario":"Ver usuario"),i.xp6(1),i.Q6J("fullscreen",!0),i.xp6(1),i.Q6J("formGroup",a.usuarioForm),i.xp6(5),i.Q6J("readonly","false"===a.edit),i.xp6(3),i.Q6J("readonly","false"===a.edit),i.xp6(3),i.Q6J("readonly","false"===a.edit),i.xp6(3),i.Q6J("readonly","false"===a.edit),i.xp6(1),i.Q6J("ngIf","false"===a.edit),i.xp6(1),i.Q6J("ngIf","false"===a.edit),i.xp6(1),i.Q6J("ngIf","true"===a.edit),i.xp6(1),i.Q6J("ngIf","false"===a.edit),i.xp6(1),i.Q6J("ngIf","true"===a.edit),i.xp6(1),i.Q6J("ngIf","true"===a.edit),i.xp6(6),i.Q6J("ngIf","true"===a.edit))},dependencies:[g.sg,g.O5,r._Y,r.JJ,r.JL,r.Q7,r.sg,r.u,u.YG,u.wI,u.W2,u.jY,u.pK,u.Ie,u.Q$,u.Nd,u.t9,u.n0,u.QI,u.j9,b.G]}),n})()}];let k=(()=>{var o;class n{}return(o=n).\u0275fac=function(t){return new(t||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[c.Bz.forChild(L),c.Bz]}),n})();var z=s(8554);let M=(()=>{var o;class n{}return(o=n).\u0275fac=function(t){return new(t||o)},o.\u0275mod=i.oAB({type:o}),o.\u0275inj=i.cJS({imports:[g.ez,r.u5,r.UX,u.Pc,k,z.m]}),n})()}}]);