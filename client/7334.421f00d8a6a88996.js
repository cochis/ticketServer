"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7334],{7334:(j,m,r)=>{r.r(m),r.d(m,{EditarFiestaPageModule:()=>O});var g=r(6814),s=r(6223),l=r(9843),f=r(4828),u=r(5861),t=r(5879),p=r(7203),h=r(6942),_=r(434),v=r(4726),x=r(2363);function E(e,n){if(1&e&&(t.TgZ(0,"ion-col",5)(1,"ion-item",6),t._UZ(2,"ion-input",15),t.qZA()()),2&e){const i=t.oxw();t.xp6(2),t.Q6J("readonly","false"===i.edit)}}function b(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"ion-select-option",18),t._uU(2),t.qZA(),t.BQk()),2&e){const i=n.$implicit;t.xp6(1),t.Q6J("value",i.uid),t.xp6(1),t.Oqu(i.nombre)}}function T(e,n){if(1&e&&(t.TgZ(0,"ion-col",5)(1,"ion-item",6)(2,"ion-select",16),t.YNc(3,b,3,2,"ng-container",17),t.qZA()()()),2&e){const i=t.oxw();t.xp6(3),t.Q6J("ngForOf",i.tipoEventos)}}function F(e,n){1&e&&(t.TgZ(0,"ion-col",5)(1,"ion-item",6),t._UZ(2,"ion-datetime",19),t.qZA()())}function Z(e,n){if(1&e&&(t.TgZ(0,"ion-label"),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.Oqu(t.lcZ(2,1,i.fiesta.fecha))}}function I(e,n){if(1&e&&(t.TgZ(0,"ion-col",5)(1,"ion-item",6),t.YNc(2,Z,3,3,"ion-label",20),t.qZA()()),2&e){const i=t.oxw();t.xp6(2),t.Q6J("ngIf",i.fiesta)}}function J(e,n){if(1&e&&t._UZ(0,"img",27),2&e){const i=t.oxw(3);t.Q6J("src","http://localhost:3006/api/upload/fiestas/default.jpg"+i.fiesta.img,t.LSH)}}function P(e,n){if(1&e&&t._UZ(0,"img",27),2&e){const i=t.oxw(3);t.Q6J("src","http://localhost:3006/api/upload/fiestas/"+i.fiesta.img,t.LSH)}}function Q(e,n){if(1&e&&t._UZ(0,"img",28),2&e){const i=t.oxw(3);t.Q6J("src",i.imgTemp,t.LSH)("alt",i.fiesta.nombre)}}function S(e,n){if(1&e&&(t.ynx(0),t.YNc(1,J,1,1,"img",25),t.YNc(2,P,1,1,"img",25),t.YNc(3,Q,1,2,"img",26),t.BQk()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",""===i.fiesta.img&&!i.imgTemp),t.xp6(1),t.Q6J("ngIf",""!==i.fiesta.img&&!i.imgTemp),t.xp6(1),t.Q6J("ngIf",""!==i.fiesta.img&&i.imgTemp)}}function y(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"ion-col",5)(1,"ion-item",21)(2,"div",22)(3,"ion-label"),t._uU(4,"Imagen"),t.qZA(),t.TgZ(5,"label",23),t.YNc(6,S,4,3,"ng-container",20),t.qZA(),t.TgZ(7,"input",24),t.NdJ("change",function(o){t.CHM(i);const c=t.oxw();return t.KtG(c.cambiarImagen(o))}),t.qZA()()()()}if(2&e){const i=t.oxw();t.xp6(6),t.Q6J("ngIf",i.fiesta)}}function q(e,n){if(1&e&&t._UZ(0,"img",30),2&e){const i=t.oxw(3);t.Q6J("src","http://localhost:3006/api/upload/fiestas/"+i.fiesta.img,t.LSH)("alt",i.fiesta.nombre)("title",i.fiesta.nombre)}}function N(e,n){if(1&e&&t._UZ(0,"img",30),2&e){const i=t.oxw(3);t.Q6J("src","http://localhost:3006/api/upload/fiestas/default.jpg",t.LSH)("alt",i.fiesta.nombre)("title",i.fiesta.nombre)}}function Y(e,n){if(1&e&&(t.ynx(0),t.YNc(1,q,1,3,"img",29),t.YNc(2,N,1,3,"img",29),t.BQk()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",""!==i.fiesta.img),t.xp6(1),t.Q6J("ngIf",""===i.fiesta.img)}}function A(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"ion-col",5)(1,"ion-item",21)(2,"div",22)(3,"ion-label"),t._uU(4,"Imagen"),t.qZA(),t.TgZ(5,"label",23),t.YNc(6,Y,3,2,"ng-container",20),t.qZA(),t.TgZ(7,"input",24),t.NdJ("change",function(o){t.CHM(i);const c=t.oxw();return t.KtG(c.cambiarImagen(o))}),t.qZA()()()()}if(2&e){const i=t.oxw();t.xp6(6),t.Q6J("ngIf",i.fiesta)}}function C(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"ion-select-option",18),t._uU(2),t.qZA(),t.BQk()),2&e){const i=n.$implicit;t.xp6(1),t.Q6J("value",i.uid),t.xp6(1),t.Oqu(i.nombre)}}function L(e,n){if(1&e&&(t.TgZ(0,"ion-col",5)(1,"ion-item",6)(2,"ion-select",31),t.YNc(3,C,3,2,"ng-container",17),t.qZA()()()),2&e){const i=t.oxw();t.xp6(3),t.Q6J("ngForOf",i.tipoEventos)}}function U(e,n){if(1&e&&(t.TgZ(0,"ion-col",12)(1,"ion-button",32),t._uU(2," Editar "),t.qZA()()),2&e){const i=t.oxw();t.xp6(1),t.Q6J("disabled",i.fiestaForm.invalid)}}const k=[{path:"",component:(()=>{var e;class n{constructor(a,o,c,B,D,H,G){this.functionsService=a,this.route=o,this.fiestasService=c,this.fb=B,this.router=D,this.tipoEventosService=H,this.fileService=G,this.today=this.functionsService.getToday(),this.tipoEventos=[],this.formSubmitted=!1,this.cargando=!1,this.imgTemp=void 0,this.createForm(),this.id=this.route.snapshot.params.id,this.edit=this.route.snapshot.params.edit,this.tipoEventosService.cargarTipoEventosAll().subscribe(d=>{this.tipoEventos=d.tipoEventos,this.getId(this.id),this.offLoading()},d=>{console.log("error::: ",d)})}ngOnInit(){}getId(a){this.fiestasService.cargarFiestaById(a).subscribe(o=>{this.onLoading(),this.fiesta=o.fiesta,console.log("this.fiesta::: ",this.fiesta),this.setForm(this.fiesta),this.offLoading()},o=>{this.offLoading()})}get errorControl(){return this.fiestaForm.controls}createForm(){this.fiestaForm=this.fb.group({nombre:["",[s.kI.required,s.kI.minLength(3)]],tipoEvento:["",[s.kI.required]],cantidad:["",[s.kI.required]],fecha:["",[s.kI.required]],lugar:["",[s.kI.required]],img:[""],activated:[!1],dateCreated:[this.today],lastEdited:[this.today]})}onSubmit(){if(this.onLoading(),!this.fiestaForm.valid)return this.functionsService.presentToast("bottom","Por favor completa el formulario","danger"),void this.offLoading();console.log("  antes this.fiesta::: ",this.fiesta),this.fiesta={...this.fiesta,nombre:this.fiestaForm.value.nombre.toUpperCase(),tipoEvento:this.fiestaForm.value.tipoEvento,cantidad:this.fiestaForm.value.cantidad,fecha:new Date(this.fiestaForm.value.fecha).getTime(),lugar:this.fiestaForm.value.lugar.toUpperCase(),lastEdited:this.fiestaForm.value.lastEdited},console.log("  this.fiesta::: ",this.fiesta),this.fiestasService.actualizarFiesta(this.fiesta).subscribe(a=>{this.functionsService.presentToast("bottom","Fiesta Actualizada","primary"),this.functionsService.navigateTo("core/fiestas/vista-fiestas"),this.offLoading()},a=>{this.functionsService.presentToast("bottom","Error","danger"),this.offLoading()})}setForm(a){let o=this.functionsService.getValueCatalog(a.tipoEvento,"nombre",this.tipoEventos);console.log("new Date(fiesta.fecha)::: ",new Date(a.fecha)),this.fiestaForm=this.fb.group({nombre:[a.nombre,[s.kI.required,s.kI.minLength(3)]],tipoEvento:["false"===this.edit?o:a.tipoEvento,[s.kI.required]],cantidad:[a.cantidad,[s.kI.required]],fecha:[new Date(a.fecha).toISOString(),[s.kI.required]],lugar:[a.lugar,[s.kI.required]],img:[""],activated:[a.activated],dateCreated:[a.dateCreated],lastEdited:[this.today]})}cambiarImagen(a){if(this.imagenSubir=a.target.files[0],a.target.files[0]){console.log("file::: ",a.target.files[0]);const o=new FileReader;o.readAsDataURL(a.target.files[0]),o.onloadend=()=>{this.imgTemp=o.result,console.log("this.imgTemp ::: ",this.imgTemp)},this.subirImagen()}else this.imgTemp=null,console.log("!file::: ",this.imgTemp)}subirImagen(){this.fileService.actualizarFoto(this.imagenSubir,"fiestas",this.fiesta.uid).then(a=>{this.fiesta.img=a,console.log(" this.fiesta::: ",this.fiesta),this.functionsService.presentToast("bottom","Imagen actualizada","success")},a=>{this.functionsService.presentToast("bottom","Error al actualizar la imagen","danger")})}back(){this.functionsService.navigateTo("core/fiestas/vista-fiestas")}onLoading(){var a=this;this.functionsService.showLoading().then(function(){var o=(0,u.Z)(function*(c){a.loading=c});return function(c){return o.apply(this,arguments)}}())}offLoading(){setTimeout(()=>{this.functionsService.closeLoading(this.loading)},500)}}return(e=n).\u0275fac=function(a){return new(a||e)(t.Y36(p.d),t.Y36(f.gz),t.Y36(h.O),t.Y36(s.qu),t.Y36(f.F0),t.Y36(_.h),t.Y36(v.I))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-editar-fiesta"]],decls:27,vars:14,consts:[[3,"titulo"],[3,"fullscreen"],["novalidate","",3,"formGroup","ngSubmit"],["fixed","",1,"minHeight"],[1,"ion-text-center"],["size","12","size-md","6"],["lines","none"],["type","string","placeholder","Nombre ","name","nombre","label","Nombre","labelPlacement","floating","formControlName","nombre","required","",1,"upperC",3,"readonly"],["size","12","size-md","6",4,"ngIf"],["type","number","placeholder","Cantidad","name","cantidad","label","Cantidad","labelPlacement","floating","formControlName","cantidad","required","",3,"readonly"],["type","text","placeholder","Lugar","name","lugar","label","Lugar","labelPlacement","floating","formControlName","lugar","required","",1,"upperC",3,"readonly"],["fixed","",1,"ion-text-center"],["size","6"],["color","secondary","expand","block",1,"ion-padding","ion-no-border",3,"click"],["size","6",4,"ngIf"],["type","text","placeholder","Tipo de Evento","name","tipoEvento","label","Tipo de evento","labelPlacement","floating","formControlName","tipoEvento","required","",3,"readonly"],["label","Tipo de evento","label-placement","floating","formControlName","tipoEvento","required",""],[4,"ngFor","ngForOf"],[3,"value"],["datetime","datetime","name","fecha","formControlName","fecha","presentation","date","required","","locale","es-MX"],[4,"ngIf"],["lines","none",1,"ion-text-center"],[1,"image-upload"],["for","file-input",2,"text-align","center"],["id","file-input","type","file",1,"ion-no-border",3,"change"],["alt","Click aqu\xed para subir tu foto","title","Click aqu\xed para subir tu foto","class","img-avatar",3,"src",4,"ngIf"],["class","img-avatar",3,"src","alt",4,"ngIf"],["alt","Click aqu\xed para subir tu foto","title","Click aqu\xed para subir tu foto",1,"img-avatar",3,"src"],[1,"img-avatar",3,"src","alt"],["class","img-avatar",3,"src","alt","title",4,"ngIf"],[1,"img-avatar",3,"src","alt","title"],["label","Tipo Evento","label-placement","floating","formControlName","tipoEvento","required",""],["color","primary","type","submit","expand","block",1,"ion-padding","ion-no-border",3,"disabled"]],template:function(a,o){1&a&&(t._UZ(0,"app-header",0),t.TgZ(1,"ion-content",1)(2,"form",2),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(3,"ion-grid",3)(4,"ion-row",4)(5,"ion-col",5)(6,"ion-item",6),t._UZ(7,"ion-input",7),t.qZA()(),t.YNc(8,E,3,1,"ion-col",8),t.YNc(9,T,4,1,"ion-col",8),t.TgZ(10,"ion-col",5)(11,"ion-item",6),t._UZ(12,"ion-input",9),t.qZA()(),t.TgZ(13,"ion-col",5)(14,"ion-item",6),t._UZ(15,"ion-input",10),t.qZA()(),t.YNc(16,F,3,0,"ion-col",8),t.YNc(17,I,3,1,"ion-col",8),t.YNc(18,y,8,1,"ion-col",8),t.YNc(19,A,8,1,"ion-col",8),t.YNc(20,L,4,1,"ion-col",8),t.qZA()(),t.TgZ(21,"ion-grid",11)(22,"ion-row",4)(23,"ion-col",12)(24,"ion-button",13),t.NdJ("click",function(){return o.back()}),t._uU(25," Regresar "),t.qZA()(),t.YNc(26,U,3,1,"ion-col",14),t.qZA()()()()),2&a&&(t.Q6J("titulo","true"===o.edit?"Editar Fiesta":"Ver Fiesta"),t.xp6(1),t.Q6J("fullscreen",!0),t.xp6(1),t.Q6J("formGroup",o.fiestaForm),t.xp6(5),t.Q6J("readonly","false"===o.edit),t.xp6(1),t.Q6J("ngIf","false"===o.edit),t.xp6(1),t.Q6J("ngIf","true"===o.edit),t.xp6(3),t.Q6J("readonly","false"===o.edit),t.xp6(3),t.Q6J("readonly","false"===o.edit),t.xp6(1),t.Q6J("ngIf","true"===o.edit),t.xp6(1),t.Q6J("ngIf","false"===o.edit),t.xp6(1),t.Q6J("ngIf","true"===o.edit),t.xp6(1),t.Q6J("ngIf","false"===o.edit),t.xp6(1),t.Q6J("ngIf","true"===o.edit),t.xp6(6),t.Q6J("ngIf","true"===o.edit))},dependencies:[g.sg,g.O5,s._Y,s.JJ,s.JL,s.Q7,l.YG,l.wI,l.W2,l.x4,l.jY,l.pK,l.Ie,l.Q$,l.Nd,l.t9,l.n0,l.as,l.QI,l.j9,s.sg,s.u,x.G,g.uU]}),n})()}];let w=(()=>{var e;class n{}return(e=n).\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[f.Bz.forChild(k),f.Bz]}),n})();var z=r(4476),M=r(8554);let O=(()=>{var e;class n{}return(e=n).\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.ez,s.u5,l.Pc,w,s.UX,z.q,M.m]}),n})()}}]);