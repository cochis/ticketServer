"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9864],{9864:(Y,p,c)=>{c.r(p),c.d(p,{CrearBoletoPageModule:()=>Q});var g=c(6814),d=c(6223),r=c(9843),h=c(4828),f=c(5861),e=c(5879),v=c(7742);let C=(()=>{var o;class s{constructor(t){this.modalCtrl=t}ngOnInit(){console.log("invitado::: ",this.invitado)}cancel(){return this.modalCtrl.dismiss(null,"cancel")}confirm(){return this.modalCtrl.dismiss(this.invitado,"confirm")}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(r.IN))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-boletos"]],inputs:{invitado:"invitado",fiesta:"fiesta"},decls:16,vars:16,consts:[["slot","start"],["color","medium",3,"click"],["slot","end"],[3,"strong","click"],[1,"ion-padding"],["lines","none"],[1,"qrcodeImage"],[3,"qrdata","allowEmptyString","ariaLabel","cssClass","colorDark","colorLight","elementType","errorCorrectionLevel","imageSrc","imageHeight","imageWidth","margin","scale","title","width"],["labelPlacement","stacked","label","Enter your name","placeholder","Your name"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-button",1),e.NdJ("click",function(){return i.cancel()}),e._uU(4,"Cancel"),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6,"Welcome"),e.qZA(),e.TgZ(7,"ion-buttons",2)(8,"ion-button",3),e.NdJ("click",function(){return i.confirm()}),e._uU(9,"Confirm"),e.qZA()()()(),e.TgZ(10,"ion-content",4)(11,"ion-item",5)(12,"div",6),e._UZ(13,"qrcode",7),e.qZA()(),e.TgZ(14,"ion-item",5),e._UZ(15,"ion-input",8),e.qZA()()),2&t&&(e.xp6(8),e.Q6J("strong",!0),e.xp6(5),e.Q6J("qrdata","https://localhost:8100/core/pages/administracion/boleto/check/"+i.fiesta+"/"+i.invitado.nombreGrupo)("allowEmptyString",!0)("ariaLabel","QR Code image with the following content...")("cssClass","center")("colorDark","#183d3d")("colorLight","#ffffffff")("elementType","canvas")("errorCorrectionLevel","H")("imageSrc","./assets/images/logo.jpeg")("imageHeight",75)("imageWidth",80)("margin",4)("scale",1)("title","A custom title attribute")("width",300))},dependencies:[r.YG,r.Sm,r.W2,r.Gu,r.pK,r.Ie,r.wd,r.sr,r.j9,v.V],styles:[".qrcodeImage[_ngcontent-%COMP%]{display:flex;flex:1}.center[_ngcontent-%COMP%]{display:flex;flex:1;justify-content:center}"]}),s})();var b=c(7203),Z=c(553),T=c(7398);class B{constructor(s,a,t,i,n,l,m){this.fiesta=s,this.invitados=a,this.llena=t,this.activated=i,this.dateCreated=n,this.lastEdited=l,this.uid=m}}var _=c(9862);const u=Z.N.base_url;let x=(()=>{var o;class s{constructor(t){this.http=t}get token(){return localStorage.getItem("token")||""}get headers(){return{headers:{"x-token":this.token}}}cargarBoletosAll(){return this.http.get(`${u}/boletos/all`,this.headers).pipe((0,T.U)(i=>{const n=i.boletos.map(l=>new B(l.fiesta,l.invitados,l.llena,l.activated,l.dateCreated,l.lastEdited,l.uid));return{total:n.length,boletos:n}}))}crearBoleto(t){return console.log("formData::: ",t),console.log("${base_url}/boletos::: ",`${u}/boletos`),this.http.post(`${u}/boletos`,t,this.headers)}isActivedBoleto(t){const i=`${u}/boletos/isActive/${t.uid}`,n={...t,lastEdited:Date.now()};return this.http.put(i,n,this.headers)}actualizarBoleto(t){const i=`${u}/boletos/${t.uid}`;console.log("url::: ",i);const n={...t,lastEdited:Date.now()};return console.log("data::: ",n),this.http.put(i,n,this.headers)}cargarBoletoById(t){return this.http.get(`${u}/boletos/${t}`,this.headers)}}return(o=s).\u0275fac=function(t){return new(t||o)(e.LFG(_.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),s})();var y=c(6942),I=c(8672),S=c(2363);function A(o,s){if(1&o&&(e.TgZ(0,"h3",7),e._uU(1),e.qZA()),2&o){const a=e.oxw();e.xp6(1),e.hij("Invitados ",a.total,"")}}function P(o,s){1&o&&(e.TgZ(0,"ion-text",18)(1,"h3"),e._uU(2,"Ya no tiene boletos disponibles "),e.qZA()())}function N(o,s){if(1&o&&(e.ynx(0),e.TgZ(1,"ion-select-option",19),e._uU(2),e.qZA(),e.BQk()),2&o){const a=s.$implicit;e.xp6(1),e.Q6J("value",a.uid),e.xp6(1),e.Oqu(a.nombre)}}function G(o,s){if(1&o&&(e.TgZ(0,"div")(1,"ion-select-option",19),e._uU(2),e.qZA()()),2&o){const a=s.$implicit;e.xp6(1),e.Q6J("value",a.uid),e.xp6(1),e.Oqu(a.nombre)}}function F(o,s){if(1&o){const a=e.EpF();e.ynx(0)(1,20),e.TgZ(2,"ion-col",21)(3,"ion-select",22),e.YNc(4,G,3,2,"div",11),e.qZA()(),e.TgZ(5,"ion-col",21),e._UZ(6,"ion-input",23),e.qZA(),e.TgZ(7,"ion-col",21),e._UZ(8,"ion-input",24),e.qZA(),e.TgZ(9,"ion-col",25),e._UZ(10,"ion-input",26),e.qZA(),e.TgZ(11,"ion-col",25),e._UZ(12,"ion-input",27),e.qZA(),e.TgZ(13,"ion-col",25)(14,"ion-button",28),e.NdJ("click",function(){const n=e.CHM(a).index,l=e.oxw();return e.KtG(l.openModal(l.registerForm.value.invitados[n]))}),e._UZ(15,"ion-icon",29),e.qZA()(),e.TgZ(16,"ion-col",25)(17,"ion-button",28),e.NdJ("click",function(){const n=e.CHM(a).index,l=e.oxw();return e.KtG(l.removeInvitados(n))}),e._UZ(18,"ion-icon",30),e.qZA()(),e.BQk()()}if(2&o){const a=s.index,t=e.oxw();e.xp6(1),e.Q6J("formGroupName",a),e.xp6(3),e.Q6J("ngForOf",t.tipoGrupos)}}const q=[{path:"",component:(()=>{var o;class s{constructor(t,i,n,l,m,M){this.functionsService=t,this.fb=i,this.boletosService=n,this.fiestasService=l,this.tipoGruposServices=m,this.modalCtrl=M,this.today=this.functionsService.getToday(),this.formSubmitted=!1,this.cargando=!1,this.numeroInvitados=0,this.sumaInvitados=0,this.message="This modal example uses the modalController to present and dismiss modals.",this.onLoading(),this.getFiestas(),this.getTipoGrupos(),this.createForm(),this.offLoading()}ngOnInit(){}getFiestas(){this.fiestasService.cargarFiestasAll().subscribe(t=>{this.fiestas=this.functionsService.getActives(t.fiestas),console.log("this.fiestas ::: ",this.fiestas)},t=>{console.log("error::: ",t)})}getTipoGrupos(){this.tipoGruposServices.cargarTipoGruposAll().subscribe(t=>{this.tipoGrupos=this.functionsService.getActives(t.tipoGrupos),console.log("this.tipoGrupos::: ",this.tipoGrupos)},t=>{console.log("error::: ",t)})}get errorControl(){return this.registerForm.controls}openModal(t){var i=this;return(0,f.Z)(function*(){const n=yield i.modalCtrl.create({component:C,componentProps:{invitado:t,fiesta:i.registerForm.value.fiesta}});n.present();const{data:l}=yield n.onWillDismiss();console.log("data::: ",l)})()}createForm(){this.cargando=!0,this.registerForm=this.fb.group({fiesta:["",[d.kI.required]],llena:[!1],invitados:this.fb.array([]),activated:[!1],dateCreated:[this.today],lastEdited:[this.today]}),this.cargando=!1}get invitados(){return this.registerForm.get("invitados")}newInvitado(){return this.fb.group({tipoGrupo:["",[d.kI.required]],nombreGrupo:["",[d.kI.required]],whatsapp:[""],email:[""],cantidad:["",d.kI.required],ocupados:[0]})}selectNumero(t){console.log("event::: ",t.target.value),this.numeroInvitados=this.functionsService.getValueCatalog(t.target.value,"cantidad",this.fiestas),console.log("his.numeroInvitados ::: ",this.numeroInvitados)}cuentaInvitados(t){this.numeroInvitados=this.numeroInvitados-Number(t.target.value)}addInvitados(){this.invitados.push(this.newInvitado())}removeInvitados(t){this.invitados.removeAt(t)}onSubmit(){if(this.onLoading(),!this.registerForm.valid)return this.functionsService.presentToast("bottom","Por favor completa el formulario","danger"),this.offLoading(),console.log("Please provide all the required values!");this.boletosService.crearBoleto(this.registerForm.value).subscribe(t=>{this.functionsService.presentToast("bottom","Boleto Creado","primary"),this.functionsService.navigateTo("core/boletos/vista-boletos"),this.offLoading()},t=>{this.functionsService.presentToast("bottom","Error","danger"),this.offLoading(),console.log("error::: ",t)})}onLoading(){var t=this;this.functionsService.showLoading().then(function(){var i=(0,f.Z)(function*(n){t.loading=n});return function(n){return i.apply(this,arguments)}}())}offLoading(){setTimeout(()=>{this.functionsService.closeLoading(this.loading)},500)}back(){this.functionsService.navigateTo("core/boletos/vista-boletos")}get total(){var t=0;return this.registerForm.value.invitados.forEach(i=>{t+=i.cantidad}),t}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(b.d),e.Y36(d.qu),e.Y36(x),e.Y36(y.O),e.Y36(I.w),e.Y36(r.IN))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-crear-boleto"]],decls:28,vars:9,consts:[["titulo","Crear Boleto"],[3,"fullscreen"],["color","tertiary",1,"ion-text-center"],["class","ion-text-center",4,"ngIf"],["color","tertiary","class","ion-text-center","color","danger",4,"ngIf"],["novalidate","",3,"formGroup","ngSubmit"],["fixed","",1,"minHeight"],[1,"ion-text-center"],["size","12","size-md","6"],["lines","none"],["label","Fiesta","placeholder","Selecciona la fiesta","formControlName","fiesta","required","",3,"ionChange"],[4,"ngFor","ngForOf"],[3,"disabled","click"],["formArrayName","invitados"],["fixed",""],["size","6"],["color","secondary","expand","block",1,"ion-padding","ion-no-border",3,"click"],["color","primary","type","submit","expand","block",1,"ion-padding","ion-no-border",3,"disabled"],["color","tertiary","color","danger",1,"ion-text-center"],[3,"value"],[3,"formGroupName"],["size","12","size-md","3",1,"ion-text-center"],["label","Tipo Grupo","labelPlacement","floating","placeholder","Selecciona El tipo de grupo","formControlName","tipoGrupo","required",""],["type","string","placeholder","Nombre Grupo","name","nombreGrupo","label","Nombre del grupo","labelPlacement","floating","formControlName","nombreGrupo","required","",1,"upperC"],["type","number","placeholder","Cantidad","name","cantidad","label","Cantidad de invitados","labelPlacement","floating","formControlName","cantidad","required",""],["size","12","size-md","6",1,"ion-text-center"],["type","string","placeholder","Correo","name","email","label","Correo electr\xf3nico","labelPlacement","floating","formControlName","email","required","",1,"upperC"],["type","number","placeholder","Tel\xe9fono","name","whatsapp","label","Tel\xe9fono","labelPlacement","floating","formControlName","whatsapp","required","",1,"upperC"],[3,"click"],["name","eye-outline"],["name","trash-bin-outline"]],template:function(t,i){1&t&&(e._UZ(0,"app-header",0),e.TgZ(1,"ion-content",1)(2,"ion-text",2)(3,"h3"),e._uU(4),e.qZA(),e.YNc(5,A,2,1,"h3",3),e.qZA(),e.YNc(6,P,3,0,"ion-text",4),e.TgZ(7,"form",5),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(8,"ion-grid",6)(9,"ion-row",7)(10,"ion-col",8)(11,"ion-item",9)(12,"ion-select",10),e.NdJ("ionChange",function(l){return i.selectNumero(l)}),e.YNc(13,N,3,2,"ng-container",11),e.qZA()()(),e.TgZ(14,"ion-col",8)(15,"ion-button",12),e.NdJ("click",function(){return i.addInvitados()}),e._uU(16,"Agregar invitados"),e.qZA()()(),e.TgZ(17,"ion-row"),e.ynx(18,13),e.YNc(19,F,19,2,"ng-container",11),e.BQk(),e.qZA()(),e.TgZ(20,"ion-grid",14)(21,"ion-row",7)(22,"ion-col",15)(23,"ion-button",16),e.NdJ("click",function(){return i.back()}),e._uU(24," Regresar "),e.qZA()(),e.TgZ(25,"ion-col",15)(26,"ion-button",17),e._uU(27," Crear "),e.qZA()()()()()()),2&t&&(e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(3),e.hij("Cantidad de invitaciones: ",i.numeroInvitados," "),e.xp6(1),e.Q6J("ngIf",i.registerForm.value.invitados.length>0),e.xp6(1),e.Q6J("ngIf",i.numeroInvitados<i.total),e.xp6(1),e.Q6J("formGroup",i.registerForm),e.xp6(6),e.Q6J("ngForOf",i.fiestas),e.xp6(2),e.Q6J("disabled",0===i.numeroInvitados),e.xp6(4),e.Q6J("ngForOf",i.invitados.controls),e.xp6(7),e.Q6J("disabled",i.registerForm.invalid))},dependencies:[g.sg,g.O5,d._Y,d.JJ,d.JL,d.Q7,r.YG,r.wI,r.W2,r.jY,r.gu,r.pK,r.Ie,r.Nd,r.t9,r.n0,r.yW,r.as,r.QI,r.j9,d.sg,d.u,d.x0,d.CE,S.G]}),s})()}];let J=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[h.Bz.forChild(q),h.Bz]}),s})();var k=c(4476),U=c(8554);let Q=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.ez,d.u5,r.Pc,J,d.UX,k.q,U.m]}),s})()}}]);