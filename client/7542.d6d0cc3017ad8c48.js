"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7542],{7542:(U,p,s)=>{s.r(p),s.d(p,{EditarBoletoPageModule:()=>J});var u=s(6814),a=s(6223),l=s(9843),g=s(1896),m=s(5861),f=s(5803),h=s(553),o=s(5879),v=s(7203),b=s(8941),_=s(6942),I=s(8672),x=s(2363);function T(e,r){if(1&e&&(o.TgZ(0,"h3",7),o._uU(1),o.qZA()),2&e){const n=o.oxw();o.xp6(1),o.hij("Invitados ",n.total,"")}}function Z(e,r){1&e&&(o.TgZ(0,"ion-text",18)(1,"h3"),o._uU(2,"Ya no tiene boletos disponibles "),o.qZA()())}function E(e,r){if(1&e&&(o.ynx(0),o.TgZ(1,"ion-select-option",19),o._uU(2),o.qZA(),o.BQk()),2&e){const n=r.$implicit;o.xp6(1),o.Q6J("value",n.uid),o.xp6(1),o.Oqu(n.nombre)}}function y(e,r){if(1&e){const n=o.EpF();o.TgZ(0,"ion-button",20),o.NdJ("click",function(){o.CHM(n);const i=o.oxw();return o.KtG(i.addInvitados())}),o._uU(1,"Agregar invitados"),o.qZA()}if(2&e){const n=o.oxw();o.Q6J("disabled",0===n.numeroInvitados)}}function B(e,r){if(1&e&&(o.TgZ(0,"div")(1,"ion-select-option",19),o._uU(2),o.qZA()()),2&e){const n=r.$implicit;o.xp6(1),o.Q6J("value",n.uid),o.xp6(1),o.Oqu(n.nombre)}}function P(e,r){if(1&e){const n=o.EpF();o.TgZ(0,"ion-col",26)(1,"ion-button",29),o.NdJ("click",function(){o.CHM(n);const i=o.oxw().index,d=o.oxw();return o.KtG(d.removeInvitados(i))}),o._UZ(2,"ion-icon",32),o.qZA()()}}function C(e,r){if(1&e){const n=o.EpF();o.ynx(0)(1,21),o.TgZ(2,"ion-col",22)(3,"ion-select",23),o.YNc(4,B,3,2,"div",11),o.qZA()(),o.TgZ(5,"ion-col",22),o._UZ(6,"ion-input",24),o.qZA(),o.TgZ(7,"ion-col",22),o._UZ(8,"ion-input",25),o.qZA(),o.TgZ(9,"ion-col",26),o._UZ(10,"ion-input",27),o.qZA(),o.TgZ(11,"ion-col",26),o._UZ(12,"ion-input",28),o.qZA(),o.TgZ(13,"ion-col",26)(14,"ion-button",29),o.NdJ("click",function(){const d=o.CHM(n).index,c=o.oxw();return o.KtG(c.openModal(c.boletoForm.value.invitados[d]))}),o._UZ(15,"ion-icon",30),o.qZA()(),o.YNc(16,P,3,0,"ion-col",31),o.BQk()()}if(2&e){const n=r.index,t=o.oxw();o.xp6(1),o.Q6J("formGroupName",n),o.xp6(3),o.Q6J("ngForOf",t.tipoGrupos),o.xp6(6),o.Q6J("readonly","false"===t.edit),o.xp6(2),o.Q6J("readonly","false"===t.edit),o.xp6(4),o.Q6J("ngIf","true"===t.edit)}}function F(e,r){if(1&e&&(o.TgZ(0,"ion-col",15)(1,"ion-button",33),o._uU(2," Editar "),o.qZA()()),2&e){const n=o.oxw();o.xp6(1),o.Q6J("disabled",n.boletoForm.invalid)}}const G=[{path:"",component:(()=>{var e;class r{constructor(t,i,d,c,q,Q,Y){this.functionsService=t,this.fb=i,this.boletosService=d,this.fiestasService=c,this.tipoGruposServices=q,this.modalCtrl=Q,this.route=Y,this.today=this.functionsService.getToday(),this.formSubmitted=!1,this.cargando=!1,this.numeroInvitados=0,this.sumaInvitados=0,this.url=h.N.base_url,this.onLoading(),this.createForm(),this.getFiestas(),this.getTipoGrupos(),this.id=this.route.snapshot.params.id,this.edit=this.route.snapshot.params.edit,this.getId(this.id),this.offLoading()}ngOnInit(){}getTipoGrupos(){this.tipoGruposServices.cargarTipoGruposAll().subscribe(t=>{this.tipoGrupos=this.functionsService.getActives(t.tipoGrupos),console.log("this.tipoGrupos::: ",this.tipoGrupos)},t=>{console.log("error::: ",t)})}getId(t){this.boletosService.cargarBoletoById(t).subscribe(i=>{this.boleto=i.boleto,this.setForm(this.boleto),this.numeroInvitados=this.functionsService.getValueCatalog(this.boleto.fiesta,"cantidad",this.fiestas),console.log("his.numeroInvitados ::: ",this.numeroInvitados),this.offLoading()},i=>{this.offLoading()})}get errorControl(){return this.boletoForm.controls}setForm(t){console.log("boleto::: ",t);let i=[];this.boletoForm=this.fb.group({fiesta:[t.fiesta,[a.kI.required]],llena:[t.llena],invitados:this.fb.array([]),activated:[t.activated],dateCreated:[t.dateCreated],lastEdited:[this.today]}),i=Object.values(this.boleto.invitados),i.forEach(d=>{this.invitados.push(this.setInvitado(d))}),this.offLoading()}openModal(t){var i=this;return(0,m.Z)(function*(){const d=yield i.modalCtrl.create({component:f.h,componentProps:{invitado:t,fiesta:i.boletoForm.value.fiesta}});d.present();const{data:c}=yield d.onWillDismiss();console.log("data::: ",c)})()}createForm(){this.cargando=!0,this.boletoForm=this.fb.group({fiesta:["",[a.kI.required]],llena:[!1],invitados:this.fb.array([]),activated:[!1],dateCreated:[this.today],lastEdited:[this.today]}),this.cargando=!1}get invitados(){return this.boletoForm.get("invitados")}newInvitado(){return this.fb.group({tipoGrupo:["",[a.kI.required]],nombreGrupo:["",[a.kI.required]],whatsapp:[""],email:[""],cantidad:["",a.kI.required],ocupados:[0]})}setInvitado(t){return console.log("invitado::: ",t),this.fb.group({tipoGrupo:[""!==t.tipoGrupo?t.tipoGrupo:"",[a.kI.required]],nombreGrupo:[""!==t.nombreGrupo?t.nombreGrupo:"",[a.kI.required]],whatsapp:[void 0!==t.whatsapp?t.whatsapp:""],email:[void 0!==t.email?t.email:""],cantidad:[void 0!==t.cantidad?t.cantidad:0,a.kI.required],ocupados:[void 0!==t.ocupados?t.ocupados:0]})}selectNumero(t){console.log("event::: ",t.target.value),this.numeroInvitados=this.functionsService.getValueCatalog(t.target.value,"cantidad",this.fiestas),console.log("his.numeroInvitados ::: ",this.numeroInvitados)}cuentaInvitados(t){this.numeroInvitados=this.numeroInvitados-Number(t.target.value)}addInvitados(){this.invitados.push(this.newInvitado())}removeInvitados(t){this.invitados.removeAt(t)}onSubmit(){if(this.onLoading(),console.log("this.boletoForm.value::: ",this.boletoForm.value),this.boleto={uid:this.id,...this.boletoForm.value,llena:this.numeroInvitados===this.total},console.log("this.boleto ::: ",this.boleto),!this.boletoForm.valid)return this.functionsService.presentToast("bottom","Por favor completa el formulario","danger"),this.offLoading(),console.log("Please provide all the required values!");this.boletosService.actualizarBoleto(this.boleto).subscribe(t=>{this.functionsService.presentToast("bottom","Boleto Editado","primary"),this.functionsService.navigateTo("core/boletos/vista-boletos"),this.offLoading()},t=>{this.functionsService.presentToast("bottom","Error","danger"),this.offLoading(),console.log("error::: ",t)})}getFiestas(){this.fiestasService.cargarFiestasAll().subscribe(t=>{this.fiestas=this.functionsService.getActives(t.fiestas),console.log("this.fiestas ::: ",this.fiestas)},t=>{console.log("error::: ",t)})}onLoading(){var t=this;this.functionsService.showLoading().then(function(){var i=(0,m.Z)(function*(d){t.loading=d});return function(d){return i.apply(this,arguments)}}())}offLoading(){setTimeout(()=>{this.functionsService.closeLoading(this.loading)},500)}back(){this.functionsService.navigateTo("core/boletos/vista-boletos")}get total(){var t=0;return this.boletoForm.value.invitados.forEach(i=>{t+=i.cantidad}),t}}return(e=r).\u0275fac=function(t){return new(t||e)(o.Y36(v.d),o.Y36(a.qu),o.Y36(b.s),o.Y36(_.O),o.Y36(I.w),o.Y36(l.IN),o.Y36(g.gz))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-editar-boleto"]],decls:25,vars:10,consts:[[3,"titulo"],[3,"fullscreen"],["color","tertiary",1,"ion-text-center"],["class","ion-text-center",4,"ngIf"],["color","tertiary","class","ion-text-center","color","danger",4,"ngIf"],["novalidate","",3,"formGroup","ngSubmit"],["fixed","",1,"minHeight"],[1,"ion-text-center"],["size","12","size-md","6"],["lines","none"],["label","Fiesta","placeholder","Selecciona la fiesta","formControlName","fiesta","required","",3,"ionChange"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],["formArrayName","invitados"],["fixed","",1,"ion-text-center"],["size","6"],["color","secondary","expand","block",1,"ion-padding","ion-no-border",3,"click"],["size","6",4,"ngIf"],["color","tertiary","color","danger",1,"ion-text-center"],[3,"value"],[3,"disabled","click"],[3,"formGroupName"],["size","12","size-md","4",1,"ion-text-center"],["label","Tipo Grupo","labelPlacement","floating","placeholder","Selecciona El tipo de grupo","formControlName","tipoGrupo","required",""],["type","string","placeholder","Nombre Grupo","name","nombreGrupo","label","Nombre del grupo","labelPlacement","floating","formControlName","nombreGrupo","required","",1,"upperC"],["type","number","placeholder","Cantidad","name","cantidad","label","Cantidad de invitados","labelPlacement","floating","formControlName","cantidad","required",""],["size","12","size-md","6",1,"ion-text-center"],["type","string","placeholder","Correo","name","email","label","Correo electr\xf3nico","labelPlacement","floating","formControlName","email","required","",1,"upperC",3,"readonly"],["type","number","placeholder","Tel\xe9fono","name","whatsapp","label","Tel\xe9fono","labelPlacement","floating","formControlName","whatsapp","required","",1,"upperC",3,"readonly"],[3,"click"],["name","eye-outline"],["size","12","size-md","6","class","ion-text-center",4,"ngIf"],["name","trash-bin-outline"],["color","primary","type","submit","expand","block",1,"ion-padding","ion-no-border",3,"disabled"]],template:function(t,i){1&t&&(o._UZ(0,"app-header",0),o.TgZ(1,"ion-content",1)(2,"ion-text",2)(3,"h3"),o._uU(4),o.qZA(),o.YNc(5,T,2,1,"h3",3),o.qZA(),o.YNc(6,Z,3,0,"ion-text",4),o.TgZ(7,"form",5),o.NdJ("ngSubmit",function(){return i.onSubmit()}),o.TgZ(8,"ion-grid",6)(9,"ion-row",7)(10,"ion-col",8)(11,"ion-item",9)(12,"ion-select",10),o.NdJ("ionChange",function(c){return i.selectNumero(c)}),o.YNc(13,E,3,2,"ng-container",11),o.qZA()()(),o.TgZ(14,"ion-col",8),o.YNc(15,y,2,1,"ion-button",12),o.qZA()(),o.TgZ(16,"ion-row"),o.ynx(17,13),o.YNc(18,C,17,5,"ng-container",11),o.BQk(),o.qZA()(),o.TgZ(19,"ion-grid",14)(20,"ion-row",7)(21,"ion-col",15)(22,"ion-button",16),o.NdJ("click",function(){return i.back()}),o._uU(23," Regresar "),o.qZA()(),o.YNc(24,F,3,1,"ion-col",17),o.qZA()()()()),2&t&&(o.Q6J("titulo","true"===i.edit?"Editar Boleto":"Ver Boleto"),o.xp6(1),o.Q6J("fullscreen",!0),o.xp6(3),o.hij("Cantidad de invitaciones: ",i.numeroInvitados," "),o.xp6(1),o.Q6J("ngIf",i.boletoForm.value.invitados.length>0),o.xp6(1),o.Q6J("ngIf",i.numeroInvitados<i.total),o.xp6(1),o.Q6J("formGroup",i.boletoForm),o.xp6(6),o.Q6J("ngForOf",i.fiestas),o.xp6(2),o.Q6J("ngIf","true"===i.edit&&i.numeroInvitados>i.total),o.xp6(3),o.Q6J("ngForOf",i.invitados.controls),o.xp6(6),o.Q6J("ngIf","true"===i.edit&&i.total<=i.numeroInvitados))},dependencies:[u.sg,u.O5,a._Y,a.JJ,a.JL,a.Q7,l.YG,l.wI,l.W2,l.jY,l.gu,l.pK,l.Ie,l.Nd,l.t9,l.n0,l.yW,l.as,l.QI,l.j9,a.sg,a.u,a.x0,a.CE,x.G]}),r})()}];let N=(()=>{var e;class r{}return(e=r).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[g.Bz.forChild(G),g.Bz]}),r})();var S=s(4476),A=s(8554);let J=(()=>{var e;class r{}return(e=r).\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[u.ez,a.u5,l.Pc,N,a.UX,S.q,A.m]}),r})()}}]);