"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1960],{1960:(G,d,s)=>{s.r(d),s.d(d,{EditarUsuariosPageModule:()=>z});var g=s(6814),r=s(6223),u=s(9843),c=s(1896),m=s(5861),o=s(5879),f=s(7203),p=s(5612),h=s(8042),_=s(3429),x=s(4726),v=s(2363);function b(i,n){if(1&i&&(o.TgZ(0,"ion-col",5)(1,"ion-item",6),o._UZ(2,"ion-input",17),o.qZA()()),2&i){const e=o.oxw();o.xp6(2),o.Q6J("readonly","false"===e.edit)}}function T(i,n){if(1&i&&(o.TgZ(0,"ion-col",5)(1,"ion-item",6),o._UZ(2,"ion-input",18),o.qZA()()),2&i){const e=o.oxw();o.xp6(2),o.Q6J("readonly","false"===e.edit)}}function U(i,n){if(1&i&&o._UZ(0,"img",26),2&i){const e=o.oxw(3);o.Q6J("src","http://localhost:3006/api/upload/usuarios/default.jpg"+e.usuario.img,o.LSH)}}function Z(i,n){if(1&i&&o._UZ(0,"img",26),2&i){const e=o.oxw(3);o.Q6J("src","http://localhost:3006/api/upload/usuarios/"+e.usuario.img,o.LSH)}}function I(i,n){if(1&i&&o._UZ(0,"img",27),2&i){const e=o.oxw(3);o.Q6J("src",e.imgTemp,o.LSH)("alt",e.usuario.nombre)}}function P(i,n){if(1&i&&(o.ynx(0),o.YNc(1,U,1,1,"img",24),o.YNc(2,Z,1,1,"img",24),o.YNc(3,I,1,2,"img",25),o.BQk()),2&i){const e=o.oxw(2);o.xp6(1),o.Q6J("ngIf",""===e.usuario.img&&!e.imgTemp),o.xp6(1),o.Q6J("ngIf",""!==e.usuario.img&&!e.imgTemp),o.xp6(1),o.Q6J("ngIf",""!==e.usuario.img&&e.imgTemp)}}function E(i,n){if(1&i){const e=o.EpF();o.TgZ(0,"ion-col",5)(1,"ion-item",19)(2,"div",20)(3,"ion-label"),o._uU(4,"Imagen"),o.qZA(),o.TgZ(5,"label",21),o.YNc(6,P,4,3,"ng-container",22),o.qZA(),o.TgZ(7,"input",23),o.NdJ("change",function(a){o.CHM(e);const l=o.oxw();return o.KtG(l.cambiarImagen(a))}),o.qZA()()()()}if(2&i){const e=o.oxw();o.xp6(6),o.Q6J("ngIf",e.usuario)}}function J(i,n){if(1&i&&o._UZ(0,"img",29),2&i){const e=o.oxw(3);o.Q6J("src","http://localhost:3006/api/upload/usuarios/"+e.usuario.img,o.LSH)("alt",e.usuario.email)("title",e.usuario.email)}}function S(i,n){if(1&i&&o._UZ(0,"img",29),2&i){const e=o.oxw(3);o.Q6J("src","http://localhost:3006/api/upload/usuarios/default.jpg",o.LSH)("alt",e.usuario.email)("title",e.usuario.email)}}function y(i,n){if(1&i&&(o.ynx(0),o.YNc(1,J,1,3,"img",28),o.YNc(2,S,1,3,"img",28),o.BQk()),2&i){const e=o.oxw(2);o.xp6(1),o.Q6J("ngIf",""!==e.usuario.img),o.xp6(1),o.Q6J("ngIf",""===e.usuario.img)}}function Q(i,n){if(1&i){const e=o.EpF();o.TgZ(0,"ion-col",5)(1,"ion-item",19)(2,"div",20)(3,"ion-label"),o._uU(4,"Imagen"),o.qZA(),o.TgZ(5,"label",21),o.YNc(6,y,3,2,"ng-container",22),o.qZA(),o.TgZ(7,"input",23),o.NdJ("change",function(a){o.CHM(e);const l=o.oxw();return o.KtG(l.cambiarImagen(a))}),o.qZA()()()()}if(2&i){const e=o.oxw();o.xp6(6),o.Q6J("ngIf",e.usuario)}}function N(i,n){if(1&i&&(o.ynx(0),o.TgZ(1,"ion-select-option",32),o._uU(2),o.qZA(),o.BQk()),2&i){const e=n.$implicit;o.xp6(1),o.Q6J("value",e.uid),o.xp6(1),o.Oqu(e.nombre)}}function q(i,n){if(1&i&&(o.TgZ(0,"ion-col",5)(1,"ion-item",6)(2,"ion-select",30),o.YNc(3,N,3,2,"ng-container",31),o.qZA()()()),2&i){const e=o.oxw();o.xp6(3),o.Q6J("ngForOf",e.roles)}}function A(i,n){if(1&i&&(o.ynx(0),o.TgZ(1,"ion-select-option",32),o._uU(2),o.qZA(),o.BQk()),2&i){const e=n.$implicit;o.xp6(1),o.Q6J("value",e.uid),o.xp6(1),o.Oqu(e.nombre)}}function Y(i,n){if(1&i&&(o.TgZ(0,"ion-col",5)(1,"ion-item",6)(2,"ion-select",33),o.YNc(3,A,3,2,"ng-container",31),o.qZA()()()),2&i){const e=o.oxw();o.xp6(3),o.Q6J("ngForOf",e.salons)}}function C(i,n){if(1&i&&(o.TgZ(0,"ion-col",14)(1,"ion-button",34),o._uU(2," Editar "),o.qZA()()),2&i){const e=o.oxw();o.xp6(1),o.Q6J("disabled",e.usuarioForm.invalid)}}const F=[{path:"",component:(()=>{var i;class n{constructor(t,a,l,M,R,w,B,H){this.functionsService=t,this.route=a,this.usuariosService=l,this.fb=M,this.router=R,this.rolesService=w,this.salonsService=B,this.fileService=H,this.today=this.functionsService.getToday(),this.roles=[],this.salons=[],this.formSubmitted=!1,this.cargando=!1,this.imgTemp=void 0,this.onLoading(),this.getRoles(),this.getSalones(),this.createForm(),this.id=this.route.snapshot.params.id,this.edit=this.route.snapshot.params.edit,setTimeout(()=>{this.getId(this.id),this.offLoading()},500)}getRoles(){this.rolesService.cargarRolesAll().subscribe(t=>{this.roles=t.roles},t=>{console.log("error::: ",t)})}getSalones(){this.salonsService.cargarSalonsAll().subscribe(t=>{this.salons=t.salons,console.log("this.salons ::: ",this.salons)},t=>{console.log("error::: ",t)})}ngOnInit(){}getId(t){console.log("id::: ",t),this.usuariosService.cargarUsuarioById(t).subscribe(a=>{console.log("resp.usuario::: ",a.usuario),this.usuario=a.usuario,this.setForm(this.usuario),this.offLoading()},a=>{this.offLoading()})}get errorControl(){return this.usuarioForm.controls}createForm(){this.usuarioForm=this.fb.group({nombre:["",[r.kI.required,r.kI.minLength(3)]],apellidoPaterno:["",[r.kI.required,r.kI.minLength(3)]],apellidoMaterno:[""],email:["",[r.kI.required,r.kI.email]],salon:[""],role:["",[r.kI.required]],google:[!1],activated:[!1],dateCreated:[this.today],lastEdited:[this.today]})}onSubmit(){if(this.onLoading(),!this.usuarioForm.valid)return this.functionsService.presentToast("bottom","Por favor completa el formulario","danger"),void this.offLoading();this.usuario={...this.usuario,...this.usuarioForm.value},this.usuariosService.actualizarUsuario(this.usuario).subscribe(t=>{this.functionsService.presentToast("bottom","Usuario Creado","primary"),this.functionsService.navigateTo("core/usuarios/vista-usuarios"),this.offLoading()},t=>{this.functionsService.presentToast("bottom","Error","danger"),this.offLoading()})}setForm(t){console.log("usuario::: ",t);var a=this.functionsService.getValueCatalog(t.role,"nombre",this.roles);console.log("role::: ",a);var l="";console.log("usuario.salon::: ",t.salon),t.salon&&(l=this.functionsService.getValueCatalog(t.salon,"nombre",this.salons)),this.usuarioForm=this.fb.group({nombre:[t.nombre,[r.kI.required,r.kI.minLength(3)]],apellidoPaterno:[t.apellidoPaterno,[r.kI.required,r.kI.minLength(3)]],apellidoMaterno:[t.apellidoMaterno],email:[t.email,[r.kI.required,r.kI.email]],role:["false"===this.edit?a:t.role,[r.kI.required]],salon:["false"===this.edit?l:t.salon,[r.kI.required]],google:[t.google],activated:[t.activated],dateCreated:[t.dateCreated],lastEdited:[this.today]})}cambiarImagen(t){if(this.imagenSubir=t.target.files[0],t.target.files[0]){console.log("file::: ",t.target.files[0]);const a=new FileReader;a.readAsDataURL(t.target.files[0]),a.onloadend=()=>{this.imgTemp=a.result,console.log("this.imgTemp ::: ",this.imgTemp)},this.subirImagen()}else this.imgTemp=null,console.log("!file::: ",this.imgTemp)}subirImagen(){this.fileService.actualizarFoto(this.imagenSubir,"usuarios",this.usuario.uid).then(t=>{this.usuario.img=t,this.functionsService.presentToast("bottom","Imagen actualizada","success")},t=>{this.functionsService.presentToast("bottom","Error al actualizar la imagen","danger")})}back(){this.functionsService.navigateTo("core/usuarios/vista-usuarios")}onLoading(){var t=this;this.functionsService.showLoading().then(function(){var a=(0,m.Z)(function*(l){t.loading=l});return function(l){return a.apply(this,arguments)}}())}offLoading(){setTimeout(()=>{this.functionsService.closeLoading(this.loading)},500)}}return(i=n).\u0275fac=function(t){return new(t||i)(o.Y36(f.d),o.Y36(c.gz),o.Y36(p.J),o.Y36(r.qu),o.Y36(c.F0),o.Y36(h.f),o.Y36(_.S),o.Y36(x.I))},i.\u0275cmp=o.Xpm({type:i,selectors:[["app-editar-usuarios"]],decls:29,vars:14,consts:[[3,"titulo"],[3,"fullscreen"],["novalidate","",3,"formGroup","ngSubmit"],["fixed","",1,"minHeight"],[1,"ion-text-center"],["size","12","size-md","6"],["lines","none"],["type","string","placeholder","Nombre(s)","name","nombre","label","Nombre","labelPlacement","floating","formControlName","nombre","required","",3,"readonly"],["size","12","size-md","3"],["type","string","placeholder","Apellido paterno","name","apellidoPaterno","label","Apellido paterno","labelPlacement","floating","formControlName","apellidoPaterno","required","",3,"readonly"],["type","string","placeholder","Apellido materno","name","apellidoMaterno","label","Apellido materno","labelPlacement","floating","formControlName","apellidoMaterno","required","",3,"readonly"],["type","email","placeholder","Correo electr\xf3nico","name","email","label","Correo electr\xf3nico","labelPlacement","floating","formControlName","email","required","",3,"readonly"],["size","12","size-md","6",4,"ngIf"],["fixed","",1,"ion-text-center"],["size","6"],["color","secondary","expand","block",1,"ion-padding","ion-no-border",3,"click"],["size","6",4,"ngIf"],["type","role","placeholder","Rol","name","role","label","Rol","labelPlacement","floating","formControlName","role","required","",3,"readonly"],["type","salon","placeholder","Rol","name","salon","label","Salon","labelPlacement","floating","formControlName","salon","required","",3,"readonly"],["lines","none",1,"ion-text-center"],[1,"image-upload"],["for","file-input",2,"text-align","center"],[4,"ngIf"],["id","file-input","type","file",1,"ion-no-border",3,"change"],["alt","Click aqu\xed para subir tu foto","title","Click aqu\xed para subir tu foto","class","img-avatar",3,"src",4,"ngIf"],["class","img-avatar",3,"src","alt",4,"ngIf"],["alt","Click aqu\xed para subir tu foto","title","Click aqu\xed para subir tu foto",1,"img-avatar",3,"src"],[1,"img-avatar",3,"src","alt"],["class","img-avatar",3,"src","alt","title",4,"ngIf"],[1,"img-avatar",3,"src","alt","title"],["label","Rol","label-placement","floating","formControlName","role","required",""],[4,"ngFor","ngForOf"],[3,"value"],["label","Salon","label-placement","floating","formControlName","salon","required",""],["color","primary","type","submit","expand","block",1,"ion-padding","ion-no-border",3,"disabled"]],template:function(t,a){1&t&&(o._UZ(0,"app-header",0),o.TgZ(1,"ion-content",1)(2,"form",2),o.NdJ("ngSubmit",function(){return a.onSubmit()}),o.TgZ(3,"ion-grid",3)(4,"ion-row",4)(5,"ion-col",5)(6,"ion-item",6),o._UZ(7,"ion-input",7),o.qZA()(),o.TgZ(8,"ion-col",8)(9,"ion-item",6),o._UZ(10,"ion-input",9),o.qZA()(),o.TgZ(11,"ion-col",8)(12,"ion-item",6),o._UZ(13,"ion-input",10),o.qZA()(),o.TgZ(14,"ion-col",5)(15,"ion-item",6),o._UZ(16,"ion-input",11),o.qZA()(),o.YNc(17,b,3,1,"ion-col",12),o.YNc(18,T,3,1,"ion-col",12),o.YNc(19,E,8,1,"ion-col",12),o.YNc(20,Q,8,1,"ion-col",12),o.YNc(21,q,4,1,"ion-col",12),o.YNc(22,Y,4,1,"ion-col",12),o.qZA()(),o.TgZ(23,"ion-grid",13)(24,"ion-row",4)(25,"ion-col",14)(26,"ion-button",15),o.NdJ("click",function(){return a.back()}),o._uU(27," Regresar "),o.qZA()(),o.YNc(28,C,3,1,"ion-col",16),o.qZA()()()()),2&t&&(o.Q6J("titulo","true"===a.edit?"Editar usuario":"Ver usuario"),o.xp6(1),o.Q6J("fullscreen",!0),o.xp6(1),o.Q6J("formGroup",a.usuarioForm),o.xp6(5),o.Q6J("readonly","false"===a.edit),o.xp6(3),o.Q6J("readonly","false"===a.edit),o.xp6(3),o.Q6J("readonly","false"===a.edit),o.xp6(3),o.Q6J("readonly","false"===a.edit),o.xp6(1),o.Q6J("ngIf","false"===a.edit),o.xp6(1),o.Q6J("ngIf","false"===a.edit),o.xp6(1),o.Q6J("ngIf","true"===a.edit),o.xp6(1),o.Q6J("ngIf","false"===a.edit),o.xp6(1),o.Q6J("ngIf","true"===a.edit),o.xp6(1),o.Q6J("ngIf","true"===a.edit),o.xp6(6),o.Q6J("ngIf","true"===a.edit))},dependencies:[g.sg,g.O5,r._Y,r.JJ,r.JL,r.Q7,r.sg,r.u,u.YG,u.wI,u.W2,u.jY,u.pK,u.Ie,u.Q$,u.Nd,u.t9,u.n0,u.QI,u.j9,v.G]}),n})()}];let L=(()=>{var i;class n{}return(i=n).\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[c.Bz.forChild(F),c.Bz]}),n})();var k=s(8554);let z=(()=>{var i;class n{}return(i=n).\u0275fac=function(t){return new(t||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({imports:[g.ez,r.u5,r.UX,u.Pc,L,k.m]}),n})()}}]);